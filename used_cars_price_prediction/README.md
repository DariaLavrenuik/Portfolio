 ***Предсказание стоимости авто на вторичном рынке***

**Демонстрационная версия модели в streamlit:**

https://appappcarspy-wdcmw6gqhcokgtdqpsuytg.streamlit.app/

**Цель проекта**
Разработать модель, предсказывающую стоимость авто на вторичном рынке. Метрикой оценки является MAPE - Mean Absolute Percentage Error.

**Общий вывод**
На этапе развдочного анализа данных были сделаны следующий выводы:
В данных машины с 1982 по 2015 годы выпуска. Большинство машин с 2010 до 2015 года выпуска, меньше всего с 1985 по 2000 годы.

Данные по цене распредлены неравномерно, дешевых машин до 15 000 больше всего, чем выше цена, тем меньше машин представленно в выборке.Средняя стоимость автомобиля - 13592, максимальная - 230000б минимальная - 1. Максимальная цена и наличие выбросов могут объясняться элитными марками - Bentley,Ferrari, Land Rover.

Средний пробег машин - 68344 миль. Видна зависимость стоимости машины от пробега, чем меньше пробег, тем выше стоимость.

Большинство машин находится в хорошем состоянии по мнению их владельцев. Меньше всего машин в очень плохом состоянии и в отличном.

Почти все машины на автоматической коробке передач.

Дубликатов не обнаружено.

На этапе обработки признаков, было сделано:
С помощью библиотеки pyvin заполнили пропуски в столбцах model, make в тренировочной и тестовой выборках.В тренировочной выборке удалось восстановить 8034 марки и 8066 модели. В тестовой удалось восстановить 2060 марки и 2064 модели. Привели к одному виду марки и модели: количество марок в тернировочной выборке: 56, количество марок в тестовой выборке: 56, количество моделей в тернировочной выборке: 879, количество моделей в тестовой выборке: 780. Сделали такую же обработку для типа кузова.И свели к 9 основным: cab, convertible, coupe, wagon, van, sedan, hatchback, minivan, suv.

Заменили пропуски в данных по коробке передач на автомат.

На этапе создания признаков:
Создали синтетический признак с возрастом машины, средней стоимости по марке машины.

На этапе разработки модели:
Было протестировано 3 модели: Linear Regressor, Random Forest Regressor, Catboost Regressor. Лучшую метрику выдал Catboost.

На тестовых данных с помощью кросс валидации и гиперпараметрами max_depth = 10, была достигнула метрика MAPE 15.52.

Наиболее важными прзнаками оказались марка машины, пробег, год выпуска и средняя стоимость марки машины.
